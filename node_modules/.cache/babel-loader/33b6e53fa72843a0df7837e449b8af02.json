{"ast":null,"code":"var _jsxFileName = \"/Users/bastpaq/Documents/student_projects/semaines-intensives/cineo-bast/cineo/src/context/session.context.jsx\";\nimport React, { createContext, Component } from 'react';\nconst SessionContext = createContext({});\nexport class SessionContextProvider extends Component {\n  constructor(props) {\n    super(props);\n\n    this.signIn = (mail, password, e) => {\n      e.preventDefault();\n      let infosUsers = {};\n      infosUsers.mail = mail;\n      infosUsers.password = password;\n      fetch('http://18.191.118.60:80/signIn.php', {\n        method: 'POST',\n        body: JSON.stringify(infosUsers)\n      }).then(response => {\n        return response.json();\n      }).then(data => {\n        if (data.success) {\n          let userloged = {\n            id: data.infos[0].id,\n            name: data.infos[0].name,\n            lastName: data.infos[0].last_name,\n            pseudo: data.infos[0].pseudo,\n            mail: data.infos[0].mail,\n            signUpDate: data.infos[0].date_inscription\n          };\n          this.setState({\n            user: userloged\n          });\n          localStorage.setItem('user', JSON.stringify(userloged));\n          let userId = {};\n          userId.id = data.infos[0].id;\n          fetch('http://18.191.118.60:80/getMoviesList.php', {\n            method: 'POST',\n            body: JSON.stringify(userId)\n          }).then(response => {\n            return response.json();\n          }).then(data => {\n            if (data.length > 0) {\n              let movieList = [];\n              data.forEach(movie => {\n                movieList.push(movie.id_movie);\n              });\n              this.setState({\n                movieList: movieList\n              });\n              localStorage.setItem('moviesList', JSON.stringify(movieList));\n            }\n          });\n        } else {\n          this.setState({\n            wrongLogin: true\n          });\n        }\n      });\n    };\n\n    this.signUp = (name, firstName, mail, password, pseudo, e) => {\n      e.preventDefault();\n      let data = {};\n      data.name = name;\n      data.firstName = firstName;\n      data.mail = mail;\n      data.password = password;\n      data.pseudo = pseudo;\n      fetch('http://18.191.118.60:80/signUp.php', {\n        method: 'POST',\n        body: JSON.stringify(data)\n      }).then(response => {\n        return response.json();\n      }).then(data => {\n        if (data.message) {\n          this.setState({\n            mailAlreadyExist: true\n          });\n        } else {\n          let userLoged = {\n            id: data.user[0].id,\n            name: data.user[0].name,\n            lastName: data.user[0].last_name,\n            pseudo: data.user[0].pseudo,\n            mail: data.user[0].mail,\n            signUpDate: data.user[0].date_inscription\n          };\n          this.setState({\n            user: userLoged\n          });\n          localStorage.setItem('user', JSON.stringify(userLoged));\n        }\n      });\n    };\n\n    this.changeWarningStates = () => {\n      this.setState({\n        mailAlreadyExist: false,\n        wrongLogin: false\n      });\n    };\n\n    this.deleteUser = () => {\n      let data = {};\n      data.mail = this.state.user.mail;\n      fetch('http://18.191.118.60:80/deleteUser.php', {\n        method: 'POST',\n        body: JSON.stringify(data)\n      }).then(response => {\n        return response.json();\n      }).then(data => {\n        this.setState({\n          user: null\n        });\n        localStorage.removeItem('user');\n        localStorage.removeItem('moviesList');\n      });\n    };\n\n    this.logOut = () => {\n      this.setState({\n        user: null,\n        movieList: null\n      });\n      localStorage.removeItem('user');\n      localStorage.removeItem('moviesList');\n    };\n\n    this.addMovie = filmId => {\n      let data = {};\n      data.idUser = this.state.user.id;\n      data.idFilm = filmId.toString();\n      fetch('http://18.191.118.60:80/addFilm.php', {\n        method: 'POST',\n        body: JSON.stringify(data)\n      }).then(response => {\n        return response.json();\n      }).then(data => {\n        let movieList = [];\n        data.forEach(movie => {\n          movieList.push(movie.id_movie);\n        });\n        this.setState({\n          movieList: movieList\n        });\n        localStorage.setItem('moviesList', JSON.stringify(movieList));\n      });\n    };\n\n    this.deleteMovie = id_movie => {\n      let data = {};\n      data.movieId = id_movie.toString();\n      data.userId = this.state.user.id;\n      fetch('http://18.191.118.60:80/deleteMovie.php', {\n        method: 'POST',\n        body: JSON.stringify(data)\n      }).then(response => {\n        return response.json();\n      }).then(data => {\n        console.log(data);\n        let movieList = [];\n        data.forEach(movie => {\n          movieList.push(movie.id_movie);\n        });\n        this.setState({\n          movieList: movieList\n        });\n        localStorage.setItem('moviesList', JSON.stringify(movieList));\n      });\n    };\n\n    this.changePseudo = pseudo => {\n      let data = {};\n      data.id = this.state.user.id;\n      data.value = pseudo;\n      fetch('http://18.191.118.60:80/changePseudo.php', {\n        method: 'POST',\n        body: JSON.stringify(data)\n      }).then(response => {\n        return response.json();\n      }).then(data => {\n        let userLoged = {\n          id: data[0].id,\n          name: data[0].name,\n          lastName: data[0].last_name,\n          pseudo: data[0].pseudo,\n          mail: data[0].mail,\n          signUpDate: data[0].date_inscription\n        };\n        this.setState({\n          user: userLoged\n        });\n        localStorage.setItem('user', JSON.stringify(userLoged));\n      });\n    };\n\n    this.changeLastName = lastName => {\n      let data = {};\n      data.id = this.state.user.id;\n      data.value = lastName;\n      fetch('http://18.191.118.60:80/changeLastName.php', {\n        method: 'POST',\n        body: JSON.stringify(data)\n      }).then(response => {\n        return response.json();\n      }).then(data => {\n        console.log(data);\n        let userLoged = {\n          id: data[0].id,\n          name: data[0].name,\n          lastName: data[0].last_name,\n          pseudo: data[0].pseudo,\n          mail: data[0].mail,\n          signUpDate: data[0].date_inscription\n        };\n        this.setState({\n          user: userLoged\n        });\n        localStorage.setItem('user', JSON.stringify(userLoged));\n      });\n    };\n\n    this.changeFirstName = firstName => {\n      let data = {};\n      data.id = this.state.user.id;\n      data.value = firstName;\n      fetch('http://18.191.118.60:80/changeFirstName.php', {\n        method: 'POST',\n        body: JSON.stringify(data)\n      }).then(response => {\n        return response.json();\n      }).then(data => {\n        let userLoged = {\n          id: data[0].id,\n          name: data[0].name,\n          lastName: data[0].last_name,\n          pseudo: data[0].pseudo,\n          mail: data[0].mail,\n          signUpDate: data[0].date_inscription\n        };\n        this.setState({\n          user: userLoged\n        });\n        localStorage.setItem('user', JSON.stringify(userLoged));\n      });\n    };\n\n    this.changeMail = mail => {\n      let data = {};\n      data.id = this.state.user.id;\n      data.value = mail;\n      fetch('http://18.191.118.60:80/changeMail.php', {\n        method: 'POST',\n        body: JSON.stringify(data)\n      }).then(response => {\n        return response.json();\n      }).then(data => {\n        let userLoged = {\n          id: data[0].id,\n          name: data[0].name,\n          lastName: data[0].last_name,\n          pseudo: data[0].pseudo,\n          mail: data[0].mail,\n          signUpDate: data[0].date_inscription\n        };\n        this.setState({\n          user: userLoged\n        });\n        localStorage.setItem('user', JSON.stringify(userLoged));\n      });\n    };\n\n    this.state = {\n      user: null,\n      mailAlreadyExist: false,\n      wrongLogin: false,\n      movieList: null\n    };\n  }\n\n  componentDidMount() {\n    if (localStorage.getItem('user')) {\n      this.setState({\n        user: JSON.parse(localStorage.getItem('user'))\n      });\n    }\n\n    if (localStorage.getItem('moviesList')) {\n      this.setState({\n        movieList: JSON.parse(localStorage.getItem('moviesList'))\n      });\n    }\n  }\n\n  render() {\n    const value = { ...this.state,\n      signIn: this.signIn,\n      signUp: this.signUp,\n      changeWarningStates: this.changeWarningStates,\n      deleteUser: this.deleteUser,\n      logOut: this.logOut,\n      addMovie: this.addMovie,\n      deleteMovie: this.deleteMovie,\n      changePseudo: this.changePseudo,\n      changeLastName: this.changeLastName,\n      changeFirstName: this.changeFirstName,\n      changeMail: this.changeMail\n    };\n    return /*#__PURE__*/React.createElement(SessionContext.Provider, {\n      value: value,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 7\n      }\n    }, this.props.children);\n  }\n\n}\nexport const SessionContextConsumer = SessionContext.Consumer;","map":{"version":3,"sources":["/Users/bastpaq/Documents/student_projects/semaines-intensives/cineo-bast/cineo/src/context/session.context.jsx"],"names":["React","createContext","Component","SessionContext","SessionContextProvider","constructor","props","signIn","mail","password","e","preventDefault","infosUsers","fetch","method","body","JSON","stringify","then","response","json","data","success","userloged","id","infos","name","lastName","last_name","pseudo","signUpDate","date_inscription","setState","user","localStorage","setItem","userId","length","movieList","forEach","movie","push","id_movie","wrongLogin","signUp","firstName","message","mailAlreadyExist","userLoged","changeWarningStates","deleteUser","state","removeItem","logOut","addMovie","filmId","idUser","idFilm","toString","deleteMovie","movieId","console","log","changePseudo","value","changeLastName","changeFirstName","changeMail","componentDidMount","getItem","parse","render","children","SessionContextConsumer","Consumer"],"mappings":"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","sourcesContent":["import React, { createContext, Component } from 'react';\n\nconst SessionContext = createContext({});\n\nexport class SessionContextProvider extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      user: null,\n      mailAlreadyExist: false,\n      wrongLogin: false,\n      movieList: null,\n    };\n  }\n\n  componentDidMount() {\n    if (localStorage.getItem('user')) {\n      this.setState({ user: JSON.parse(localStorage.getItem('user')) });\n    }\n    if (localStorage.getItem('moviesList')) {\n      this.setState({\n        movieList: JSON.parse(localStorage.getItem('moviesList')),\n      });\n    }\n  }\n\n  signIn = (mail, password, e) => {\n    e.preventDefault();\n    let infosUsers = {};\n    infosUsers.mail = mail;\n    infosUsers.password = password;\n\n    fetch('http://18.191.118.60:80/signIn.php', {\n      method: 'POST',\n      body: JSON.stringify(infosUsers),\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        if (data.success) {\n          let userloged = {\n            id: data.infos[0].id,\n            name: data.infos[0].name,\n            lastName: data.infos[0].last_name,\n            pseudo: data.infos[0].pseudo,\n            mail: data.infos[0].mail,\n            signUpDate: data.infos[0].date_inscription,\n          };\n          this.setState({ user: userloged });\n          localStorage.setItem('user', JSON.stringify(userloged));\n\n          let userId = {};\n          userId.id = data.infos[0].id;\n          fetch('http://18.191.118.60:80/getMoviesList.php', {\n            method: 'POST',\n            body: JSON.stringify(userId),\n          })\n            .then((response) => {\n              return response.json();\n            })\n            .then((data) => {\n              if (data.length > 0) {\n                let movieList = [];\n                data.forEach((movie) => {\n                  movieList.push(movie.id_movie);\n                });\n                this.setState({ movieList: movieList });\n                localStorage.setItem('moviesList', JSON.stringify(movieList));\n              }\n            });\n        } else {\n          this.setState({ wrongLogin: true });\n        }\n      });\n  };\n\n  signUp = (name, firstName, mail, password, pseudo, e) => {\n    e.preventDefault();\n\n    let data = {};\n\n    data.name = name;\n    data.firstName = firstName;\n    data.mail = mail;\n    data.password = password;\n    data.pseudo = pseudo;\n\n    fetch('http://18.191.118.60:80/signUp.php', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        if (data.message) {\n          this.setState({ mailAlreadyExist: true });\n        } else {\n          let userLoged = {\n            id: data.user[0].id,\n            name: data.user[0].name,\n            lastName: data.user[0].last_name,\n            pseudo: data.user[0].pseudo,\n            mail: data.user[0].mail,\n            signUpDate: data.user[0].date_inscription,\n          };\n          this.setState({ user: userLoged });\n          localStorage.setItem('user', JSON.stringify(userLoged));\n        }\n      });\n  };\n\n  changeWarningStates = () => {\n    this.setState({ mailAlreadyExist: false, wrongLogin: false });\n  };\n\n  deleteUser = () => {\n    let data = {};\n    data.mail = this.state.user.mail;\n\n    fetch('http://18.191.118.60:80/deleteUser.php', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        this.setState({ user: null });\n        localStorage.removeItem('user');\n        localStorage.removeItem('moviesList');\n      });\n  };\n\n  logOut = () => {\n    this.setState({ user: null, movieList: null });\n    localStorage.removeItem('user');\n    localStorage.removeItem('moviesList');\n  };\n\n  addMovie = (filmId) => {\n    let data = {};\n    data.idUser = this.state.user.id;\n    data.idFilm = filmId.toString();\n\n    fetch('http://18.191.118.60:80/addFilm.php', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        let movieList = [];\n        data.forEach((movie) => {\n          movieList.push(movie.id_movie);\n        });\n        this.setState({ movieList: movieList });\n        localStorage.setItem('moviesList', JSON.stringify(movieList));\n      });\n  };\n\n  deleteMovie = (id_movie) => {\n    let data = {};\n    data.movieId = id_movie.toString();\n    data.userId = this.state.user.id;\n\n    fetch('http://18.191.118.60:80/deleteMovie.php', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        console.log(data);\n        let movieList = [];\n        data.forEach((movie) => {\n          movieList.push(movie.id_movie);\n        });\n        this.setState({ movieList: movieList });\n        localStorage.setItem('moviesList', JSON.stringify(movieList));\n      });\n  };\n\n  changePseudo = (pseudo) => {\n    let data = {};\n    data.id = this.state.user.id;\n    data.value = pseudo;\n\n    fetch('http://18.191.118.60:80/changePseudo.php', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        let userLoged = {\n          id: data[0].id,\n          name: data[0].name,\n          lastName: data[0].last_name,\n          pseudo: data[0].pseudo,\n          mail: data[0].mail,\n          signUpDate: data[0].date_inscription,\n        };\n        this.setState({ user: userLoged });\n        localStorage.setItem('user', JSON.stringify(userLoged));\n      });\n  };\n\n  changeLastName = (lastName) => {\n    let data = {};\n    data.id = this.state.user.id;\n    data.value = lastName;\n\n    fetch('http://18.191.118.60:80/changeLastName.php', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        console.log(data);\n        let userLoged = {\n          id: data[0].id,\n          name: data[0].name,\n          lastName: data[0].last_name,\n          pseudo: data[0].pseudo,\n          mail: data[0].mail,\n          signUpDate: data[0].date_inscription,\n        };\n        this.setState({ user: userLoged });\n        localStorage.setItem('user', JSON.stringify(userLoged));\n      });\n  };\n\n  changeFirstName = (firstName) => {\n    let data = {};\n    data.id = this.state.user.id;\n    data.value = firstName;\n\n    fetch('http://18.191.118.60:80/changeFirstName.php', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        let userLoged = {\n          id: data[0].id,\n          name: data[0].name,\n          lastName: data[0].last_name,\n          pseudo: data[0].pseudo,\n          mail: data[0].mail,\n          signUpDate: data[0].date_inscription,\n        };\n        this.setState({ user: userLoged });\n        localStorage.setItem('user', JSON.stringify(userLoged));\n      });\n  };\n\n  changeMail = (mail) => {\n    let data = {};\n    data.id = this.state.user.id;\n    data.value = mail;\n\n    fetch('http://18.191.118.60:80/changeMail.php', {\n      method: 'POST',\n      body: JSON.stringify(data),\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((data) => {\n        let userLoged = {\n          id: data[0].id,\n          name: data[0].name,\n          lastName: data[0].last_name,\n          pseudo: data[0].pseudo,\n          mail: data[0].mail,\n          signUpDate: data[0].date_inscription,\n        };\n        this.setState({ user: userLoged });\n        localStorage.setItem('user', JSON.stringify(userLoged));\n      });\n  };\n\n  render() {\n    const value = {\n      ...this.state,\n      signIn: this.signIn,\n      signUp: this.signUp,\n      changeWarningStates: this.changeWarningStates,\n      deleteUser: this.deleteUser,\n      logOut: this.logOut,\n      addMovie: this.addMovie,\n      deleteMovie: this.deleteMovie,\n      changePseudo: this.changePseudo,\n      changeLastName: this.changeLastName,\n      changeFirstName: this.changeFirstName,\n      changeMail: this.changeMail,\n    };\n\n    return (\n      <SessionContext.Provider value={value}>\n        {this.props.children}\n      </SessionContext.Provider>\n    );\n  }\n}\n\nexport const SessionContextConsumer = SessionContext.Consumer;\n"]},"metadata":{},"sourceType":"module"}